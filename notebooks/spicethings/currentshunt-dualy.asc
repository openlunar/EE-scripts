Version 4
SHEET 1 3156 2404
WIRE 96 32 -352 32
WIRE 160 32 96 32
WIRE 384 32 240 32
WIRE 528 32 384 32
WIRE 736 32 528 32
WIRE 928 32 736 32
WIRE 1056 32 928 32
WIRE 1152 32 1056 32
WIRE 1472 32 1152 32
WIRE 928 80 928 32
WIRE 528 128 528 32
WIRE 1056 160 1056 32
WIRE 864 208 624 208
WIRE 928 208 928 160
WIRE 928 208 864 208
WIRE 384 240 384 32
WIRE 736 256 736 32
WIRE 928 320 928 208
WIRE 384 352 384 320
WIRE 528 352 528 208
WIRE 544 352 528 352
WIRE 624 352 624 208
WIRE 624 352 608 352
WIRE 736 368 736 336
WIRE 1056 368 1056 240
WIRE 1056 368 992 368
WIRE 384 384 384 352
WIRE 736 384 736 368
WIRE -304 400 -304 336
WIRE -48 400 -48 336
WIRE 464 400 432 400
WIRE 528 400 528 352
WIRE 528 400 464 400
WIRE 624 400 624 352
WIRE 688 400 624 400
WIRE 528 416 528 400
WIRE 1056 416 1056 368
WIRE -208 448 -240 448
WIRE -160 448 -208 448
WIRE -112 448 -160 448
WIRE -304 512 -304 496
WIRE -208 512 -208 448
WIRE -208 512 -304 512
WIRE -48 512 -48 496
WIRE -48 512 -128 512
WIRE 928 512 928 416
WIRE 1056 512 1056 496
WIRE -304 528 -304 512
WIRE -48 528 -48 512
WIRE 576 560 576 432
WIRE 624 560 576 560
WIRE 656 560 624 560
WIRE 736 592 736 560
WIRE 384 608 384 560
FLAG 96 32 vin
FLAG 1056 512 0
FLAG 1152 32 vout
FLAG 928 512 0
FLAG 384 608 0
FLAG -352 112 0
FLAG 384 352 vs1
FLAG 736 368 vs2
FLAG 864 208 vz
FLAG -304 608 0
FLAG -48 608 0
FLAG 624 560 vgg
FLAG -128 512 vgg
FLAG -304 336 vs1
FLAG -48 336 vs2
FLAG 528 512 0
FLAG 736 592 0
FLAG 464 400 vg1
FLAG -160 448 vbb
SYMBOL res 144 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10
SYMBOL res 1040 144 R0
SYMATTR InstName R8
SYMATTR Value {rset}
SYMBOL res 1040 400 R0
SYMATTR InstName R9
SYMATTR Value 25K
SYMBOL zht431 928 384 M0
SYMATTR InstName U2
SYMBOL pmos 432 480 R180
SYMATTR InstName M1
SYMATTR Value Si7461DP
SYMBOL pmos 688 480 M180
SYMATTR InstName M2
SYMATTR Value Si7461DP
SYMATTR Value2 TEMP=130
SYMBOL res 368 224 R0
SYMATTR InstName R2
SYMATTR Value 0.1
SYMBOL res 752 240 M0
SYMATTR InstName R3
SYMATTR Value 0.1
SYMBOL voltage -352 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL res 912 64 R0
SYMATTR InstName R4
SYMATTR Value 800
SYMBOL pnp -240 496 R180
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL pnp -112 496 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL pmos 576 512 R180
SYMATTR InstName M3
SYMATTR Value BSS84
SYMBOL res -320 512 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -64 512 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 512 112 R0
SYMATTR InstName R7
SYMATTR Value 800
SYMBOL res 720 464 R0
SYMATTR InstName R10
SYMATTR Value 0
SYMBOL res 368 464 R0
SYMATTR InstName R11
SYMATTR Value 0
SYMBOL diode 544 368 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
TEXT 48 -176 Left 2 !.op
TEXT 48 -104 Left 2 !.lib zht431.sub
TEXT 48 -152 Left 2 ;.step param qtemp 30 130 20
TEXT 824 -48 Left 2 ;Q2 TEMP = 100C
TEXT 1120 272 Left 2 ;Set to 12.5V, with ~0.2V drop on D1
TEXT 1120 296 Left 2 ;we are charging cells to 4.1Vcell
TEXT 48 -80 Left 2 !.lib 2STBN15D100.sub
TEXT 48 -128 Left 2 !.step param rset 35k 125k 10k
