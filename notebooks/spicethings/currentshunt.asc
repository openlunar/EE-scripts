Version 4
SHEET 1 3156 740
WIRE -1088 -144 -1216 -144
WIRE -976 -144 -1088 -144
WIRE -848 -144 -976 -144
WIRE -720 -144 -848 -144
WIRE -592 -144 -720 -144
WIRE -480 -144 -592 -144
WIRE -352 -144 -480 -144
WIRE -96 -144 -352 -144
WIRE -1216 -112 -1216 -144
WIRE -1088 -112 -1088 -144
WIRE -976 -112 -976 -144
WIRE -848 -112 -848 -144
WIRE -720 -112 -720 -144
WIRE -592 -112 -592 -144
WIRE -480 -112 -480 -144
WIRE -352 -112 -352 -144
WIRE -1216 16 -1216 -16
WIRE -1088 16 -1088 -16
WIRE -976 16 -976 -16
WIRE -848 16 -848 -16
WIRE -720 16 -720 -16
WIRE -592 16 -592 -16
WIRE -480 16 -480 -16
WIRE -352 16 -352 -16
WIRE -96 32 -96 -144
WIRE 96 32 -96 32
WIRE 160 32 96 32
WIRE 384 32 240 32
WIRE 624 32 384 32
WIRE 720 32 624 32
WIRE 864 32 720 32
WIRE 1056 32 864 32
WIRE 1472 32 1056 32
WIRE 1712 32 1536 32
WIRE 624 48 624 32
WIRE 864 48 864 32
WIRE 1712 64 1712 32
WIRE 384 96 384 32
WIRE -1216 144 -1216 112
WIRE -1088 144 -1088 112
WIRE -976 144 -976 112
WIRE -848 144 -848 112
WIRE -720 144 -720 112
WIRE -592 144 -592 112
WIRE -480 144 -480 112
WIRE -352 144 -352 112
WIRE 1056 160 1056 32
WIRE 384 176 304 176
WIRE 448 176 384 176
WIRE 528 176 448 176
WIRE 560 176 528 176
WIRE 800 176 752 176
WIRE 448 272 448 176
WIRE 752 272 752 176
WIRE 752 272 448 272
WIRE 1056 272 1056 240
WIRE 1056 272 928 272
WIRE -1216 304 -1216 240
WIRE -1088 304 -1088 240
WIRE -976 304 -976 240
WIRE -848 304 -848 240
WIRE -720 304 -720 240
WIRE -592 304 -592 240
WIRE -480 304 -480 240
WIRE -352 304 -352 240
WIRE 1712 304 1712 144
WIRE 1728 304 1712 304
WIRE 1056 336 1056 272
WIRE 1056 432 1056 416
WIRE -1216 448 -1216 400
WIRE -1088 448 -1088 400
WIRE -976 448 -976 400
WIRE -848 448 -848 400
WIRE -720 448 -720 400
WIRE -592 448 -592 400
WIRE -480 448 -480 400
WIRE -352 448 -352 400
WIRE 304 528 304 176
WIRE -1216 576 -1216 544
WIRE -1088 576 -1088 544
WIRE -976 576 -976 544
WIRE -848 576 -848 544
WIRE -720 576 -720 544
WIRE -592 576 -592 544
WIRE -480 576 -480 544
WIRE -352 576 -352 544
WIRE 928 576 928 272
WIRE 928 576 368 576
WIRE 304 656 304 624
FLAG 96 32 vin
FLAG 720 32 vout
FLAG 528 176 vbase
FLAG 624 224 0
FLAG 1056 432 0
FLAG -352 576 0
FLAG 304 656 0
FLAG 1728 384 0
FLAG 864 224 0
FLAG -480 576 0
FLAG -592 576 0
FLAG -720 576 0
FLAG -848 576 0
FLAG -976 576 0
FLAG -1088 576 0
FLAG -1216 576 0
SYMBOL res 144 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 0.001
SYMBOL pnp 560 224 M180
SYMATTR InstName Q1
SYMATTR Value D45H11
SYMBOL res 368 80 R0
SYMATTR InstName R3
SYMATTR Value 800
SYMBOL res 1040 144 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 1040 320 R0
SYMATTR InstName R9
SYMATTR Value 25K
SYMBOL pvcell -352 192 R0
SYMATTR InstName U3
SYMBOL pvcell -352 352 R0
SYMATTR InstName U4
SYMBOL pvcell -352 496 R0
SYMATTR InstName U5
SYMBOL zht431 304 592 M0
SYMATTR InstName U2
SYMBOL pvcell -352 64 R0
SYMATTR InstName U6
SYMBOL res 1696 48 R0
SYMATTR InstName R4
SYMATTR Value 0.18
SYMBOL voltage 1728 288 R0
SYMATTR InstName V1
SYMATTR Value {vbatt}
SYMBOL pvcell -352 -64 R0
SYMATTR InstName U1
SYMBOL pnp 800 224 M180
SYMATTR InstName Q2
SYMATTR Value D45H11
SYMATTR Value2 temp=100
SYMBOL res 848 32 R0
SYMATTR InstName R2
SYMATTR Value 1
SYMBOL res 608 32 R0
SYMATTR InstName R5
SYMATTR Value 1
SYMBOL pvcell -480 192 R0
SYMATTR InstName U7
SYMBOL pvcell -480 352 R0
SYMATTR InstName U8
SYMBOL pvcell -480 496 R0
SYMATTR InstName U9
SYMBOL pvcell -480 64 R0
SYMATTR InstName U10
SYMBOL pvcell -480 -64 R0
SYMATTR InstName U11
SYMBOL pvcell -592 192 R0
SYMATTR InstName U12
SYMBOL pvcell -592 352 R0
SYMATTR InstName U13
SYMBOL pvcell -592 496 R0
SYMATTR InstName U14
SYMBOL pvcell -592 64 R0
SYMATTR InstName U15
SYMBOL pvcell -592 -64 R0
SYMATTR InstName U16
SYMBOL pvcell -720 192 R0
SYMATTR InstName U17
SYMBOL pvcell -720 352 R0
SYMATTR InstName U18
SYMBOL pvcell -720 496 R0
SYMATTR InstName U19
SYMBOL pvcell -720 64 R0
SYMATTR InstName U20
SYMBOL pvcell -720 -64 R0
SYMATTR InstName U21
SYMBOL pvcell -848 192 R0
SYMATTR InstName U22
SYMBOL pvcell -848 352 R0
SYMATTR InstName U23
SYMBOL pvcell -848 496 R0
SYMATTR InstName U24
SYMBOL pvcell -848 64 R0
SYMATTR InstName U25
SYMBOL pvcell -848 -64 R0
SYMATTR InstName U26
SYMBOL pvcell -976 192 R0
SYMATTR InstName U27
SYMBOL pvcell -976 352 R0
SYMATTR InstName U28
SYMBOL pvcell -976 496 R0
SYMATTR InstName U29
SYMBOL pvcell -976 64 R0
SYMATTR InstName U30
SYMBOL pvcell -976 -64 R0
SYMATTR InstName U31
SYMBOL pvcell -1088 192 R0
SYMATTR InstName U32
SYMBOL pvcell -1088 352 R0
SYMATTR InstName U33
SYMBOL pvcell -1088 496 R0
SYMATTR InstName U34
SYMBOL pvcell -1088 64 R0
SYMATTR InstName U35
SYMBOL pvcell -1088 -64 R0
SYMATTR InstName U36
SYMBOL pvcell -1216 192 R0
SYMATTR InstName U37
SYMBOL pvcell -1216 352 R0
SYMATTR InstName U38
SYMBOL pvcell -1216 496 R0
SYMATTR InstName U39
SYMBOL pvcell -1216 64 R0
SYMATTR InstName U40
SYMBOL pvcell -1216 -64 R0
SYMATTR InstName U41
SYMBOL schottky 1472 48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RBR10BM30A
SYMATTR Description Diode
SYMATTR Type diode
TEXT 48 -176 Left 2 !.op
TEXT 48 -128 Left 2 !.lib pvcell.sub
TEXT 48 -104 Left 2 !.lib zht431.sub
TEXT 48 -152 Left 2 !.step param vbatt 11 12.9 0.01
TEXT 824 -48 Left 2 ;Q2 TEMP = 100C
TEXT 1784 200 Left 2 ;Roughly, a 3S1P battery pack
TEXT 1320 -56 Left 2 ;D1 just to limit to charging regime
TEXT 1120 272 Left 2 ;Set to 12.5V, with ~0.2V drop on D1
TEXT 1120 296 Left 2 ;we are charging cells to 4.1Vcell
