Version 4
SHEET 1 3156 2404
WIRE 96 32 -352 32
WIRE 160 32 96 32
WIRE 384 32 240 32
WIRE 736 32 384 32
WIRE 928 32 736 32
WIRE 1056 32 928 32
WIRE 1152 32 1056 32
WIRE 1472 32 1152 32
WIRE 1712 32 1536 32
WIRE -352 64 -352 32
WIRE 1712 64 1712 32
WIRE 736 112 736 32
WIRE 384 160 384 32
WIRE 560 160 384 160
WIRE 928 160 928 112
WIRE 928 160 800 160
WIRE 1056 160 1056 32
WIRE -352 192 -352 160
WIRE 1712 192 1712 144
WIRE 640 304 464 304
WIRE 672 304 640 304
WIRE 736 304 736 208
WIRE 736 304 672 304
WIRE -352 320 -352 288
WIRE 928 320 928 160
WIRE 384 336 384 160
WIRE 560 336 560 160
WIRE 1056 368 1056 240
WIRE 1056 368 992 368
WIRE 464 384 464 304
WIRE 464 384 448 384
WIRE 672 384 672 304
WIRE 672 384 624 384
WIRE 1056 416 1056 368
WIRE 672 432 672 384
WIRE -352 448 -352 416
WIRE 928 512 928 416
WIRE 1056 512 1056 496
WIRE 1712 512 1712 272
WIRE -352 576 -352 544
WIRE -352 704 -352 672
FLAG 96 32 vin
FLAG 1056 512 0
FLAG -352 704 0
FLAG 1712 512 0
FLAG 672 512 0
FLAG 560 512 0
FLAG 384 512 0
FLAG 1152 32 vout
FLAG 640 304 vbase
FLAG 928 512 0
SYMBOL res 144 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 0.001
SYMBOL res 1040 144 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 1040 400 R0
SYMATTR InstName R9
SYMATTR Value 25K
SYMBOL pvcell -352 368 R0
SYMATTR InstName U3
SYMATTR Value2 Illumination=32
SYMBOL pvcell -352 496 R0
SYMATTR InstName U4
SYMATTR Value2 Illumination=32
SYMBOL pvcell -352 624 R0
SYMATTR InstName U5
SYMATTR Value2 Illumination=32
SYMBOL zht431 928 384 M0
SYMATTR InstName U2
SYMBOL pvcell -352 240 R0
SYMATTR InstName U6
SYMATTR Value2 Illumination=32
SYMBOL res 1696 48 R0
SYMATTR InstName R4
SYMATTR Value 0.09
SYMBOL voltage 1712 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V1
SYMATTR Value {vbatt}
SYMBOL pvcell -352 112 R0
SYMATTR InstName U1
SYMATTR Value2 Illumination=32
SYMBOL schottky 1472 48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RBR10BM30A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 368 416 R0
SYMATTR InstName R2
SYMATTR Value 0.5
SYMBOL res 544 416 R0
SYMATTR InstName R3
SYMATTR Value 0.5
SYMBOL res 656 416 R0
SYMATTR InstName R7
SYMATTR Value 800
SYMBOL res 912 16 R0
SYMATTR InstName R5
SYMATTR Value 800
SYMBOL pnp 800 208 R180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL 2STBN15D100 576 384 M0
SYMATTR InstName U43
SYMATTR Value2 TJ=100
SYMBOL 2STBN15D100 400 384 M0
SYMATTR InstName U42
TEXT 48 -176 Left 2 !.op
TEXT 48 -128 Left 2 !.lib pvcell.sub
TEXT 48 -104 Left 2 !.lib zht431.sub
TEXT 48 -152 Left 2 !.step param vbatt 10.4 12.9 0.01
TEXT 824 -48 Left 2 ;Q2 TEMP = 100C
TEXT 1784 200 Left 2 ;Roughly, a 3S2P battery pack
TEXT 1320 -56 Left 2 ;D1 just to limit to charging regime
TEXT 1120 272 Left 2 ;Set to 12.5V, with ~0.2V drop on D1
TEXT 1120 296 Left 2 ;we are charging cells to 4.1Vcell
TEXT 48 -80 Left 2 !.lib 2STBN15D100.sub
TEXT -768 -16 Left 2 ;These are illumination=32, so effectively 160 cells total
TEXT -768 8 Left 2 ;it's hacky, but still accurate and simulates more quickly
TEXT -768 32 Left 2 ;(wait is it accurate?)
